{{- define "main" }}

{{- if not .IsHome | and .Title }}
<header class="page-header page-header--papers">
  {{- partial "breadcrumbs.html" . }}
  <h1>{{ .Title }}</h1>
  {{- if .Description }}
  <div class="post-description">
    {{ .Description | markdownify }}
  </div>
  {{- end }}
</header>
{{- end }}

{{- if .Content }}
<div class="post-content">
  {{- if not (.Param "disableAnchoredHeadings") }}
  {{- partial "anchored_headings.html" .Content -}}
  {{- else }}{{ .Content }}{{ end }}
</div>
{{- end }}

{{- $pages := sort .RegularPages "Date" "desc" }}

{{- $published := where $pages "Params.paperStatus" "published" }}
{{- $working := where $pages "Params.paperStatus" "working" }}
{{- $wip := where $pages "Params.paperStatus" "wip" }}

{{- if $published }}
<section class="papers-section">
<h2 class="papers-section__title">Published papers</h2>
{{- range $published }}
{{- partial "paper_entry.html" (dict "page" .) }}
{{- end }}
</section>
{{- end }}

{{- if $working }}
<section class="papers-section">
<h2 class="papers-section__title">Working papers</h2>
{{- range $working }}
{{- partial "paper_entry.html" (dict "page" .) }}
{{- end }}
</section>
{{- end }}

{{- if $wip }}
<section class="papers-section">
<h2 class="papers-section__title">Work in progress</h2>
{{- range $wip }}
{{- partial "paper_entry.html" (dict "page" .) }}
{{- end }}
</section>
{{- end }}

{{- end }}



